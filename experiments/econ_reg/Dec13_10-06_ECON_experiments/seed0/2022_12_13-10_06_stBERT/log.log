2022-12-13 10:06:38,341 INFO 

		 *** NEW EXPERIMENT ***
args=Namespace(adam_epsilon=1e-08, convert_abstain_to_random=False, datapath='../data', dataset='econ_reg', debug=False, device=device(type='cuda'), downsample=1.0, eval_batch_size=16, experiment_folder='../experiments/econ_reg', finetuning_rate=0.0001, fp16=False, hard_student_rule=False, learning_rate=0.0001, logdir='../experiments/econ_reg/Dec13_10-06_ECON_experiments/seed0/2022_12_13-10_06_stBERT', logging_steps=500, loss_weights=False, lower_case=False, max_grad_norm=1.0, max_rule_seq_length=10, max_seq_length=64, max_size=1000, metric='mse', n_gpu=1, no_cuda=False, num_epochs=15, num_iter=25, num_labels=1, num_supervised_trials=5, num_unsup_epochs=25, oversample=1, overwrite=False, sample_size=16384, seed=0, soft_labels=False, student_name='bert', teacher_name='ran', tokenizer_method='clean', train_batch_size=16, unsup_batch_size=128, warmup_steps=0, weak_sources=None, weight_decay=0.0)
2022-12-13 10:06:38,342 INFO building student: bert
2022-12-13 10:06:38,342 INFO building teacher
2022-12-13 10:06:38,342 INFO No weak sources specified for Teacher. Using default: ['econ_regrules']
2022-12-13 10:06:38,343 INFO loading data
2022-12-13 10:06:38,353 INFO Pre-processing train data for student...
2022-12-13 10:06:38,354 INFO train DATASET: 247 examples
2022-12-13 10:06:38,354 INFO train LABELS:
3.338052914979758
2022-12-13 10:06:38,357 INFO Pre-processing dev data for student...
2022-12-13 10:06:38,357 INFO dev DATASET: 18 examples
2022-12-13 10:06:38,357 INFO dev LABELS:
2.138967777777778
2022-12-13 10:06:38,357 INFO [4.57732, 5.39412, 3.88678, 0.93698, -1.04081, -0.58869, -1.53302, 3.76668, 7.29736, 10.30496, 13.36852, 10.56301, 9.14988, 7.2547, 5.47138, 5.17, 3.60142, 2.24206, 5.36784, 6.19179, 6.78258, 5.42076, 0.52335, -1.7829, -2.43001, -0.76976, 2.72709, 6.16873, 7.77884, 8.0145, 6.57755, 3.21555, 2.40215, 0.9469, 1.99603, 3.04933, 1.98087, 3.07291, 0.35513, -2.87143, -2.01841, -0.7248, 2.65814, 7.41665, 9.1219, 6.73, 4.58866, 4.92542, 2.05821, 2.48539, 0.88268, -0.66913, 1.56445, 3.00992, 6.39553, 7.56728, 6.72769, 6.00401, 4.3071, 3.59787, 3.82216, 4.81693, 5.15824, 6.21582, 6.18075, 5.51983, 5.15634, 5.47714, 5.65928, 6.3469, 8.46216, 8.4775, 7.49014, 6.04287, 4.50502, 2.92504, 2.63752, 2.73849, 2.67084, 3.84521, 5.51558, 5.33667, 4.95957, 4.4716, 3.06714, 2.9501, 2.04665, 0.32493, 0.16284, 0.42258, -0.1667, 2.69724, 3.10661, 3.00589, 4.3672, 3.47607, 5.25519, 5.38194, 6.89448, 7.56189, 6.31966, 4.77109, 4.02376, 0.63877, -0.20842, -0.629, -1.94545, -2.29905, -1.83426, 0.79868, 2.55402, 6.15239, 6.17259, 4.95864, 4.31481, 3.22596, 4.46632, 5.7709, 5.01203, 4.11706, 6.07815, 5.24577, 6.6581, 6.50991, 2.65686, 2.38992, 1.28456, 1.42078, -0.77506, -1.6238, -0.03913, 1.59998, 2.9687, 4.32577, 1.2999, -2.19035, -1.01057, -2.55592, -1.44316, 1.43146, 3.26853, 5.73717, 7.89997, 8.57828, 7.9967, 6.90084, 5.5758, 4.55509, 3.68422, 4.26244, 4.18227, 4.14559, 3.70158, 3.11924, 2.90803, 2.71584, 3.35848, 3.26693, 4.47902, 4.24219, 4.4846, 4.19287, 3.79897, 4.31524, 3.74829, 3.90811, 2.7438, 2.8213, 2.41277, 1.72722, 0.60286, -0.95024, -0.53889, -0.10272, 1.1665, 2.85887, 3.16976, 3.66532, 4.38259, 3.31998, 2.80667, 2.28652, 2.60762, 3.43052, 4.2254, 4.33678, 4.11593, 3.48113, 2.40217, 2.67311, 2.19958, 2.6011, 4.00213, 4.04992, 4.42131, 4.31413, 4.30807, 4.6738, 4.48768, 4.85501, 4.09573, 4.09777, 4.87954, 4.82186, 4.72753, 4.80021, 4.82763, 4.22596, 5.24468, 3.97408, 2.90162, 2.19554, 0.99193, 0.48735, 0.17064, 1.32881, 1.32288, 2.14067, 1.99129, 1.67619, 1.95699, 3.23991, 4.29508, 4.35338, 4.23481, 3.49083, 3.35577, 3.90862, 3.60741, 3.44767, 2.98267, 3.22486, 2.97727, 2.32829, 2.6089, 1.54072, 1.93864, 2.39856, 2.16088, 1.4468, 1.38013, 0.2422, -2.54034, -3.28239, -3.9955, -3.13768, 0.08166]
2022-12-13 10:06:38,360 INFO Pre-processing test data for student...
2022-12-13 10:06:38,360 INFO test DATASET: 32 examples
2022-12-13 10:06:38,360 INFO test LABELS:
2.1615075
2022-12-13 10:06:38,364 INFO Pre-processing unlabeled data for student...
2022-12-13 10:06:38,364 INFO unlabeled DATASET: 444 examples
2022-12-13 10:06:38,364 INFO unlabeled LABELS:
-999.0
2022-12-13 10:06:38,364 INFO creating pseudo-dataset
2022-12-13 10:06:38,364 INFO copying data from unlabeled dataset
2022-12-13 10:06:38,373 INFO done
2022-12-13 10:06:38,380 INFO PSEUDO-DATASET:
444 examples
 with mean PSEUDO-LABELS:
-999.0
2022-12-13 10:06:38,380 INFO copying data from train dataset
2022-12-13 10:06:38,386 INFO done
2022-12-13 10:06:38,389 INFO PSEUDO-DATASET:
247 examples
 with mean PSEUDO-LABELS:
3.3380529149797575
2022-12-13 10:06:38,389 INFO Class labels: 1
2022-12-13 10:06:38,390 INFO X Train Shape (247, 7) (247,)
2022-12-13 10:06:38,390 INFO X Dev Shape (18, 7) (18,)
2022-12-13 10:06:45,848 INFO Saving supervised_student to ../experiments/econ_reg/Dec13_10-06_ECON_experiments/seed0/2022_12_13-10_06_stBERT/supervised_student
2022-12-13 10:06:45,848 INFO Saving model at ../experiments/econ_reg/Dec13_10-06_ECON_experiments/seed0/2022_12_13-10_06_stBERT/supervised_student/final_model.h5
2022-12-13 10:06:45,858 INFO 

	*** Evaluating on dev data ***
2022-12-13 10:06:45,859 INFO Predicting labels for 18 texts
2022-12-13 10:06:45,985 INFO Evaluating student dev on 18 examples
2022-12-13 10:06:45,987 INFO student dev performance: 12.72
2022-12-13 10:06:45,988 INFO {'mse': 12.724145315072679, 'r2': 16.943265386491813, 'var_explained': 17.69760274046067, 'ignored': 0, 'total': 18, 'perf': 12.724145315072679}
2022-12-13 10:06:45,988 INFO 

	*** Evaluating on test data ***
2022-12-13 10:06:45,988 INFO Predicting labels for 32 texts
2022-12-13 10:06:46,101 INFO Evaluating student test on 32 examples
2022-12-13 10:06:46,102 INFO student test performance: 1.67
2022-12-13 10:06:46,102 INFO initializing teacher on unlabeled data with majority voting
2022-12-13 10:06:46,102 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 10:06:46,103 INFO There are 3/7 active rules
2022-12-13 10:06:46,103 INFO Coverage: 100.0% (444/444)
2022-12-13 10:06:46,108 INFO evaluating majority voting
2022-12-13 10:06:46,109 INFO Applying Teacher with 7 LF(s) on 247 data
2022-12-13 10:06:46,109 INFO There are 7/7 active rules
2022-12-13 10:06:46,109 INFO Coverage: 100.0% (247/247)
2022-12-13 10:06:46,114 INFO Evaluating teacher train on 247 examples
2022-12-13 10:06:46,115 INFO teacher train performance: 1.96
2022-12-13 10:06:46,116 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 10:06:46,116 INFO There are 7/7 active rules
2022-12-13 10:06:46,116 INFO Coverage: 100.0% (18/18)
2022-12-13 10:06:46,117 INFO Evaluating teacher dev on 18 examples
2022-12-13 10:06:46,118 INFO teacher dev performance: 10.07
2022-12-13 10:06:46,118 INFO Applying Teacher with 7 LF(s) on 32 data
2022-12-13 10:06:46,118 INFO There are 7/7 active rules
2022-12-13 10:06:46,119 INFO Coverage: 100.0% (32/32)
2022-12-13 10:06:46,122 INFO Evaluating teacher test on 32 examples
2022-12-13 10:06:46,123 INFO teacher test performance: 0.29
2022-12-13 10:06:46,123 INFO 

	 *** Starting loop 0 ***
2022-12-13 10:06:46,123 INFO Adding Student as extra rule in Teacher
2022-12-13 10:06:46,123 INFO Getting rule predictions
2022-12-13 10:06:46,123 INFO Applying Teacher with 7 LF(s) on 247 data
2022-12-13 10:06:46,124 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 10:06:46,124 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 10:06:46,124 INFO Getting student predictions on train (and dev) dataset
2022-12-13 10:06:46,125 INFO Predicting labels for 247 texts
2022-12-13 10:06:46,236 INFO Predicting labels for 18 texts
2022-12-13 10:06:47,364 INFO Predicting labels for 444 texts
2022-12-13 10:06:47,477 INFO Training Rule Attention Network
2022-12-13 10:06:47,478 INFO X Train Shape (247, 7) (247, 8, 1) (247,)
2022-12-13 10:06:47,479 INFO X Dev Shape (18, 7) (18, 8, 1) (18,)
2022-12-13 10:06:47,485 INFO X Unsup Shape (444, 7) (444, 8, 1)
2022-12-13 10:06:47,573 INFO 

		*** Training RAN ***
2022-12-13 10:06:49,692 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 10:06:49,693 INFO Predicting labels for 444 texts
2022-12-13 10:06:49,810 INFO There are 3/7 active rules
2022-12-13 10:06:49,810 INFO Coverage: 100.0% (444/444)
2022-12-13 10:06:49,813 INFO RAN - Predicting labels for 444 texts
2022-12-13 10:06:49,899 INFO the predictions are
2022-12-13 10:06:49,899 INFO [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
2022-12-13 10:06:49,907 INFO DONE, Getting attention scores...
2022-12-13 10:06:49,966 INFO the attention scores are
2022-12-13 10:06:49,966 INFO [[-0.62909514  3.583565    7.967066   ...  7.967066    7.967066
   7.967066  ]
 [-0.58208776  3.404801    7.807337   ...  7.807337    7.807337
   7.807337  ]
 [-0.52201474  2.7279348   5.7407837  ...  5.7407837   5.7407837
   5.7407837 ]
 ...
 [-0.51436496  4.066781    3.9339616  ... 11.583782   11.583782
  11.583782  ]
 [-0.5075332   3.989517    3.8789573  ... 11.22205    11.22205
  11.22205   ]
 [-0.48592392  3.9004102   3.783857   ... 10.886783   10.886783
  10.886783  ]]
2022-12-13 10:06:49,967 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 10:06:49,967 INFO Predicting labels for 18 texts
2022-12-13 10:06:50,078 INFO There are 7/7 active rules
2022-12-13 10:06:50,079 INFO Coverage: 100.0% (18/18)
2022-12-13 10:06:50,080 INFO RAN - Predicting labels for 18 texts
2022-12-13 10:06:50,111 INFO the predictions are
2022-12-13 10:06:50,111 INFO [[1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]
 [1.]]
2022-12-13 10:06:50,112 INFO DONE, Getting attention scores...
2022-12-13 10:06:50,170 INFO the attention scores are
2022-12-13 10:06:50,171 INFO [[-5.55894279e+00  4.52252464e+01  1.63992615e+01  4.79511528e+01
   4.59101181e+01  4.04431648e+01  3.93280106e+01  4.24813156e+01]
 [-6.03057718e+00  4.98822861e+01  1.80960159e+01  5.26611023e+01
   5.05171547e+01  4.44996719e+01  4.31978951e+01  4.64477997e+01]
 [-6.24206686e+00  5.19080467e+01  1.90419044e+01  5.42511597e+01
   5.18956032e+01  4.60226707e+01  4.46587448e+01  4.72012253e+01]
 [-5.74599218e+00  4.82955513e+01  1.83104782e+01  4.97379532e+01
   4.76384583e+01  4.23581390e+01  4.10574341e+01  4.30330887e+01]
 [-5.40486050e+00  4.52706718e+01  1.71422234e+01  4.63708191e+01
   4.48204536e+01  3.93472481e+01  3.83299904e+01  4.03147583e+01]
 [-5.14212656e+00  4.18052406e+01  1.61413689e+01  4.27098579e+01
   4.11281395e+01  3.62030983e+01  3.54037361e+01  3.72715683e+01]
 [-4.83242989e+00  3.98997726e+01  1.50399456e+01  4.12456436e+01
   3.98684120e+01  3.48593559e+01  3.39404182e+01  3.67864113e+01]
 [-5.02655888e+00  4.12206230e+01  1.50002966e+01  4.33787727e+01
   4.18590317e+01  3.65053596e+01  3.55094109e+01  3.88891716e+01]
 [-2.45015574e+00  1.49083309e+01  1.26628771e+01  9.78251171e+00
   1.04842825e+01  8.80669212e+00  7.72064018e+00  1.87272530e+01]
 [-2.78211093e+00  2.82824755e+00  2.52783513e+00 -5.25182188e-01
  -2.16231436e-01 -5.13548553e-01 -1.65534019e-02  5.12985420e+00]
 [ 5.08368835e-02  1.67800391e+00  1.10633540e+00 -3.04302979e+00
   4.57251698e-01 -2.04887795e+00 -1.23994184e+00  5.19152641e+00]
 [-4.57036823e-01  8.28778028e-01 -5.43068945e-02  5.09476662e-01
   4.92659658e-01 -7.91684389e-02  7.51618862e-01  4.07782650e+00]
 [-2.65984797e+00  1.16773777e+01  1.85907018e+00  2.49467049e+01
   2.67706566e+01  1.88630962e+01  1.94405556e+01  2.76540699e+01]
 [-1.06723051e+01  7.26694717e+01  2.10094795e+01  8.81644363e+01
   8.66475677e+01  7.10165634e+01  7.21605148e+01  8.59069595e+01]
 [-1.07657547e+01  8.56711884e+01  2.66939049e+01  1.00506142e+02
   9.32957458e+01  8.40677643e+01  8.14485245e+01  8.98722839e+01]
 [-9.95566463e+00  9.86497498e+01  3.20523109e+01  1.03179901e+02
   1.03445084e+02  8.78422546e+01  8.24714050e+01  9.80400162e+01]
 [-1.19209461e+01  9.40662613e+01  3.18911629e+01  9.66050339e+01
   9.47943420e+01  8.01013336e+01  7.76297836e+01  9.18454514e+01]
 [-7.54463339e+00  6.77810135e+01  2.39421768e+01  6.88106918e+01
   6.83870087e+01  5.78907051e+01  5.55043602e+01  6.45291138e+01]]
2022-12-13 10:06:50,174 INFO Evaluating teacher dev iter0 on 18 examples
2022-12-13 10:06:50,175 INFO teacher dev iter0 performance: 19.90
