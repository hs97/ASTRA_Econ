2022-12-13 10:23:58,128 INFO 

		 *** NEW EXPERIMENT ***
args=Namespace(adam_epsilon=1e-08, convert_abstain_to_random=False, datapath='../data', dataset='econ_reg', debug=False, device=device(type='cuda'), downsample=1.0, eval_batch_size=16, experiment_folder='../experiments/econ_reg', finetuning_rate=0.0001, fp16=False, hard_student_rule=False, learning_rate=0.0001, logdir='../experiments/econ_reg/Dec13_10-23_ECON_experiments/seed0/2022_12_13-10_23_stBERT', logging_steps=500, loss_weights=False, lower_case=False, max_grad_norm=1.0, max_rule_seq_length=10, max_seq_length=64, max_size=1000, metric='mse', n_gpu=1, no_cuda=False, num_epochs=15, num_iter=25, num_labels=1, num_supervised_trials=5, num_unsup_epochs=25, oversample=1, overwrite=False, sample_size=16384, seed=0, soft_labels=False, student_name='bert', teacher_name='ran', tokenizer_method='clean', train_batch_size=16, unsup_batch_size=128, warmup_steps=0, weak_sources=None, weight_decay=0.0)
2022-12-13 10:23:58,128 INFO building student: bert
2022-12-13 10:23:58,128 INFO building teacher
2022-12-13 10:23:58,128 INFO No weak sources specified for Teacher. Using default: ['econ_regrules']
2022-12-13 10:23:58,128 INFO loading data
2022-12-13 10:23:58,134 INFO Pre-processing train data for student...
2022-12-13 10:23:58,135 INFO train DATASET: 247 examples
2022-12-13 10:23:58,135 INFO train LABELS:
3.338052914979758
2022-12-13 10:23:58,137 INFO Pre-processing dev data for student...
2022-12-13 10:23:58,137 INFO dev DATASET: 18 examples
2022-12-13 10:23:58,137 INFO dev LABELS:
2.138967777777778
2022-12-13 10:23:58,138 INFO [4.57732, 5.39412, 3.88678, 0.93698, -1.04081, -0.58869, -1.53302, 3.76668, 7.29736, 10.30496, 13.36852, 10.56301, 9.14988, 7.2547, 5.47138, 5.17, 3.60142, 2.24206, 5.36784, 6.19179, 6.78258, 5.42076, 0.52335, -1.7829, -2.43001, -0.76976, 2.72709, 6.16873, 7.77884, 8.0145, 6.57755, 3.21555, 2.40215, 0.9469, 1.99603, 3.04933, 1.98087, 3.07291, 0.35513, -2.87143, -2.01841, -0.7248, 2.65814, 7.41665, 9.1219, 6.73, 4.58866, 4.92542, 2.05821, 2.48539, 0.88268, -0.66913, 1.56445, 3.00992, 6.39553, 7.56728, 6.72769, 6.00401, 4.3071, 3.59787, 3.82216, 4.81693, 5.15824, 6.21582, 6.18075, 5.51983, 5.15634, 5.47714, 5.65928, 6.3469, 8.46216, 8.4775, 7.49014, 6.04287, 4.50502, 2.92504, 2.63752, 2.73849, 2.67084, 3.84521, 5.51558, 5.33667, 4.95957, 4.4716, 3.06714, 2.9501, 2.04665, 0.32493, 0.16284, 0.42258, -0.1667, 2.69724, 3.10661, 3.00589, 4.3672, 3.47607, 5.25519, 5.38194, 6.89448, 7.56189, 6.31966, 4.77109, 4.02376, 0.63877, -0.20842, -0.629, -1.94545, -2.29905, -1.83426, 0.79868, 2.55402, 6.15239, 6.17259, 4.95864, 4.31481, 3.22596, 4.46632, 5.7709, 5.01203, 4.11706, 6.07815, 5.24577, 6.6581, 6.50991, 2.65686, 2.38992, 1.28456, 1.42078, -0.77506, -1.6238, -0.03913, 1.59998, 2.9687, 4.32577, 1.2999, -2.19035, -1.01057, -2.55592, -1.44316, 1.43146, 3.26853, 5.73717, 7.89997, 8.57828, 7.9967, 6.90084, 5.5758, 4.55509, 3.68422, 4.26244, 4.18227, 4.14559, 3.70158, 3.11924, 2.90803, 2.71584, 3.35848, 3.26693, 4.47902, 4.24219, 4.4846, 4.19287, 3.79897, 4.31524, 3.74829, 3.90811, 2.7438, 2.8213, 2.41277, 1.72722, 0.60286, -0.95024, -0.53889, -0.10272, 1.1665, 2.85887, 3.16976, 3.66532, 4.38259, 3.31998, 2.80667, 2.28652, 2.60762, 3.43052, 4.2254, 4.33678, 4.11593, 3.48113, 2.40217, 2.67311, 2.19958, 2.6011, 4.00213, 4.04992, 4.42131, 4.31413, 4.30807, 4.6738, 4.48768, 4.85501, 4.09573, 4.09777, 4.87954, 4.82186, 4.72753, 4.80021, 4.82763, 4.22596, 5.24468, 3.97408, 2.90162, 2.19554, 0.99193, 0.48735, 0.17064, 1.32881, 1.32288, 2.14067, 1.99129, 1.67619, 1.95699, 3.23991, 4.29508, 4.35338, 4.23481, 3.49083, 3.35577, 3.90862, 3.60741, 3.44767, 2.98267, 3.22486, 2.97727, 2.32829, 2.6089, 1.54072, 1.93864, 2.39856, 2.16088, 1.4468, 1.38013, 0.2422, -2.54034, -3.28239, -3.9955, -3.13768, 0.08166]
2022-12-13 10:23:58,141 INFO Pre-processing test data for student...
2022-12-13 10:23:58,141 INFO test DATASET: 32 examples
2022-12-13 10:23:58,141 INFO test LABELS:
2.1615075
2022-12-13 10:23:58,144 INFO Pre-processing unlabeled data for student...
2022-12-13 10:23:58,144 INFO unlabeled DATASET: 444 examples
2022-12-13 10:23:58,144 INFO unlabeled LABELS:
-999.0
2022-12-13 10:23:58,144 INFO creating pseudo-dataset
2022-12-13 10:23:58,144 INFO copying data from unlabeled dataset
2022-12-13 10:23:58,154 INFO done
2022-12-13 10:23:58,157 INFO PSEUDO-DATASET:
444 examples
 with mean PSEUDO-LABELS:
-999.0
2022-12-13 10:23:58,157 INFO copying data from train dataset
2022-12-13 10:23:58,163 INFO done
2022-12-13 10:23:58,165 INFO PSEUDO-DATASET:
247 examples
 with mean PSEUDO-LABELS:
3.3380529149797575
2022-12-13 10:23:58,165 INFO Class labels: 1
2022-12-13 10:23:58,166 INFO X Train Shape (247, 7) (247,)
2022-12-13 10:23:58,166 INFO X Dev Shape (18, 7) (18,)
2022-12-13 10:24:09,114 INFO Saving supervised_student to ../experiments/econ_reg/Dec13_10-23_ECON_experiments/seed0/2022_12_13-10_23_stBERT/supervised_student
2022-12-13 10:24:09,114 INFO Saving model at ../experiments/econ_reg/Dec13_10-23_ECON_experiments/seed0/2022_12_13-10_23_stBERT/supervised_student/final_model.h5
2022-12-13 10:24:09,125 INFO 

	*** Evaluating on dev data ***
2022-12-13 10:24:09,125 INFO Predicting labels for 18 texts
2022-12-13 10:24:09,249 INFO Evaluating student dev on 18 examples
2022-12-13 10:24:09,250 INFO student dev performance: 12.72
2022-12-13 10:24:09,250 INFO {'mse': 12.724145315072679, 'r2': 16.943265386491813, 'var_explained': 17.69760274046067, 'ignored': 0, 'total': 18, 'perf': 12.724145315072679}
2022-12-13 10:24:09,250 INFO 

	*** Evaluating on test data ***
2022-12-13 10:24:09,250 INFO Predicting labels for 32 texts
2022-12-13 10:24:09,365 INFO Evaluating student test on 32 examples
2022-12-13 10:24:09,366 INFO student test performance: 1.67
2022-12-13 10:24:09,366 INFO initializing teacher on unlabeled data with majority voting
2022-12-13 10:24:09,366 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 10:24:09,367 INFO There are 3/7 active rules
2022-12-13 10:24:09,367 INFO Coverage: 100.0% (444/444)
2022-12-13 10:24:09,371 INFO evaluating majority voting
2022-12-13 10:24:09,371 INFO Applying Teacher with 7 LF(s) on 247 data
2022-12-13 10:24:09,372 INFO There are 7/7 active rules
2022-12-13 10:24:09,372 INFO Coverage: 100.0% (247/247)
2022-12-13 10:24:09,375 INFO Evaluating teacher train on 247 examples
2022-12-13 10:24:09,376 INFO teacher train performance: 1.96
2022-12-13 10:24:09,377 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 10:24:09,377 INFO There are 7/7 active rules
2022-12-13 10:24:09,377 INFO Coverage: 100.0% (18/18)
2022-12-13 10:24:09,379 INFO Evaluating teacher dev on 18 examples
2022-12-13 10:24:09,379 INFO teacher dev performance: 10.07
2022-12-13 10:24:09,380 INFO Applying Teacher with 7 LF(s) on 32 data
2022-12-13 10:24:09,380 INFO There are 7/7 active rules
2022-12-13 10:24:09,380 INFO Coverage: 100.0% (32/32)
2022-12-13 10:24:09,382 INFO Evaluating teacher test on 32 examples
2022-12-13 10:24:09,383 INFO teacher test performance: 0.29
2022-12-13 10:24:09,384 INFO 

	 *** Starting loop 0 ***
2022-12-13 10:24:09,384 INFO Adding Student as extra rule in Teacher
2022-12-13 10:24:09,384 INFO Getting rule predictions
2022-12-13 10:24:09,384 INFO Applying Teacher with 7 LF(s) on 247 data
2022-12-13 10:24:09,384 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 10:24:09,384 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 10:24:09,385 INFO Getting student predictions on train (and dev) dataset
2022-12-13 10:24:09,385 INFO Predicting labels for 247 texts
2022-12-13 10:24:09,500 INFO Predicting labels for 18 texts
2022-12-13 10:24:09,608 INFO Predicting labels for 444 texts
2022-12-13 10:24:09,722 INFO Training Rule Attention Network
2022-12-13 10:24:09,723 INFO X Train Shape (247, 7) (247, 8) (247,)
2022-12-13 10:24:09,723 INFO X Dev Shape (18, 7) (18, 8) (18,)
2022-12-13 10:24:09,729 INFO X Unsup Shape (444, 7) (444, 8)
2022-12-13 10:24:09,797 INFO 

		*** Training RAN ***
2022-12-13 10:24:11,707 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 10:24:11,708 INFO Predicting labels for 444 texts
2022-12-13 10:24:11,826 INFO There are 3/7 active rules
2022-12-13 10:24:11,826 INFO Coverage: 100.0% (444/444)
2022-12-13 10:24:11,834 INFO RAN - Predicting labels for 444 texts
2022-12-13 10:24:11,901 INFO DONE, Getting attention scores...
2022-12-13 10:24:11,967 INFO the attention scores are
2022-12-13 10:24:11,967 INFO (444, 8)
2022-12-13 10:24:11,968 INFO [[ 1.00000000e+00 -2.94869000e+00 -9.99000000e+02 ... -9.99000000e+02
  -9.99000000e+02 -9.99000000e+02]
 [ 1.00000000e+00 -2.75736000e+00 -9.99000000e+02 ... -9.99000000e+02
  -9.99000000e+02 -9.99000000e+02]
 [ 1.00000000e+00 -7.87400000e-02 -9.99000000e+02 ... -9.99000000e+02
  -9.99000000e+02 -9.99000000e+02]
 ...
 [ 1.00000000e+00 -3.71401000e+00 -2.13952000e+00 ... -9.99000000e+02
  -9.99000000e+02  3.93627539e+00]
 [ 1.00000000e+00 -2.56603000e+00 -2.90272000e+00 ... -9.99000000e+02
  -9.99000000e+02  3.86859912e+00]
 [ 1.00000000e+00 -1.60938000e+00 -3.23101000e+00 ... -9.99000000e+02
  -9.99000000e+02  3.83700435e+00]]
2022-12-13 10:24:11,970 INFO [[nan nan nan ... nan nan nan]
 [nan nan nan ... nan nan nan]
 [nan nan nan ... nan nan nan]
 ...
 [nan nan nan ... nan nan nan]
 [nan nan nan ... nan nan nan]
 [nan nan nan ... nan nan nan]]
2022-12-13 10:24:11,971 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 10:24:11,971 INFO Predicting labels for 18 texts
2022-12-13 10:24:13,110 INFO There are 7/7 active rules
2022-12-13 10:24:13,110 INFO Coverage: 100.0% (18/18)
2022-12-13 10:24:13,112 INFO RAN - Predicting labels for 18 texts
2022-12-13 10:24:13,137 INFO DONE, Getting attention scores...
2022-12-13 10:24:13,198 INFO the attention scores are
2022-12-13 10:24:13,198 INFO (18, 8)
2022-12-13 10:24:13,198 INFO [[  1.           4.13052     -1.0397       3.09512535   3.2640617
    3.36577426   3.38303295   3.74570201]
 [  1.           4.32185     -1.16019      3.26444319   3.38013403
    3.42866391   3.45133803   3.69176021]
 [  1.           4.13052     -0.09388      3.17231135   3.13661551
    3.19246989   3.2085621    3.7404877 ]
 [  1.           3.3652       0.37592      2.45453612   2.10439016
    2.17771614   2.19542974   3.74528048]
 [  1.           4.13052      0.57936      2.32457052   2.34719456
    2.25001327   2.26135611   3.76101001]
 [  1.           3.55653      0.2345       2.30350816   2.39490513
    2.42491638   2.41907165   3.73167016]
 [  1.           3.74786     -1.31536      2.44877788   2.62815397
    2.66483617   2.67631789   3.69222505]
 [  1.           4.32185     -1.67532      2.67637763   2.88433132
    2.94144384   2.95495034   3.71147699]
 [  1.         -17.87243     -2.26674      1.18132536   0.47719557
    0.73805402   0.76381479   3.94327977]
 [  1.          -9.07125     -2.44369     -6.64196399 -10.47253677
   -9.79685495  -9.72717433   3.91855079]
 [  1.          -2.94869     -2.70229     -1.2448897    2.50850567
    0.65652246   0.65661963   3.89366301]
 [  1.          -2.18337     -1.98187     -0.81204923  -0.14289642
    1.27295365   1.09075199   3.96299655]
 [  1.          20.01091     -6.77519      1.49854892   3.09643784
    3.15310123   3.34717023   3.50553497]
 [  1.          12.54904    -10.4054      11.11174653  16.26117834
   15.78320197  15.77421789   3.15038757]
 [  1.           7.76579    -11.62188      4.70926655   0.65812355
    3.15291517   3.2200178    3.03716262]
 [  1.           7.95712    -15.96234      5.35883863   5.56750998
    3.97744687   4.24789846   2.61943487]
 [  1.           7.95712    -15.74107      3.62418387   2.53832359
    2.77953225   2.58725645   2.59260978]
 [  1.           7.00047    -12.37459      2.01389003   1.1590782
    0.93962593   0.96931809   2.6567521 ]]
2022-12-13 10:24:13,201 INFO [[nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]
 [nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan nan]]
2022-12-13 10:24:13,209 INFO Evaluating teacher dev iter0 on 18 examples
2022-12-13 10:24:13,210 INFO teacher dev iter0 performance: 19.90
