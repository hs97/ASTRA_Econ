2022-12-13 11:25:37,023 INFO 

		 *** NEW EXPERIMENT ***
args=Namespace(adam_epsilon=1e-08, convert_abstain_to_random=False, datapath='../data', dataset='econ', debug=False, device=device(type='cuda'), downsample=1.0, eval_batch_size=16, experiment_folder='../experiments/econ', finetuning_rate=0.0001, fp16=False, hard_student_rule=False, learning_rate=0.0001, logdir='../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT', logging_steps=500, loss_weights=False, lower_case=False, max_grad_norm=1.0, max_rule_seq_length=10, max_seq_length=64, max_size=1000, metric='weighted_acc', n_gpu=1, no_cuda=False, num_epochs=15, num_iter=25, num_labels=2, num_supervised_trials=5, num_unsup_epochs=25, oversample=3, overwrite=False, sample_size=16384, seed=0, soft_labels=False, student_name='bert', teacher_name='ran', tokenizer_method='clean', train_batch_size=16, unsup_batch_size=128, warmup_steps=0, weak_sources=None, weight_decay=0.0)
2022-12-13 11:25:37,023 INFO building student: bert
2022-12-13 11:25:37,023 INFO building teacher
2022-12-13 11:25:37,023 INFO No weak sources specified for Teacher. Using default: ['econrules']
2022-12-13 11:25:37,023 INFO loading data
2022-12-13 11:25:37,025 INFO Pre-processing train data for student...
2022-12-13 11:25:37,028 INFO train DATASET: 247 examples
2022-12-13 11:25:37,030 INFO train LABELS:
1    182
0     65
Name: label, dtype: int64
2022-12-13 11:25:37,030 INFO Oversampling train data 3 times
2022-12-13 11:25:37,033 INFO train DATASET: 741 examples
2022-12-13 11:25:37,035 INFO train LABELS:
1    546
0    195
Name: label, dtype: int64
2022-12-13 11:25:37,036 INFO Pre-processing dev data for student...
2022-12-13 11:25:37,038 INFO dev DATASET: 18 examples
2022-12-13 11:25:37,040 INFO dev LABELS:
1    11
0     7
Name: label, dtype: int64
2022-12-13 11:25:37,041 INFO Pre-processing test data for student...
2022-12-13 11:25:37,044 INFO test DATASET: 32 examples
2022-12-13 11:25:37,046 INFO test LABELS:
1    18
0    14
Name: label, dtype: int64
2022-12-13 11:25:37,048 INFO Pre-processing unlabeled data for student...
2022-12-13 11:25:37,050 INFO unlabeled DATASET: 444 examples
2022-12-13 11:25:37,052 INFO unlabeled LABELS:
0    444
Name: label, dtype: int64
2022-12-13 11:25:37,052 INFO creating pseudo-dataset
2022-12-13 11:25:37,052 INFO copying data from unlabeled dataset
2022-12-13 11:25:37,062 INFO done
2022-12-13 11:25:37,062 INFO [WARNING] sample size = 16384 > 444
2022-12-13 11:25:37,062 INFO Downsampling 444 data
2022-12-13 11:25:37,063 INFO copying data from train dataset
2022-12-13 11:25:37,073 INFO done
2022-12-13 11:25:37,074 INFO Balancing Pseudo Dataset to keep 1092 items...
2022-12-13 11:25:37,078 INFO PSEUDO-DATASET:
1092 examples
PSEUDO-LABELS:
1    546
0    546
Name: label, dtype: int64
2022-12-13 11:25:37,078 INFO Class labels: 2
2022-12-13 11:25:37,080 INFO X Train Shape (1092, 7) (1092,)
2022-12-13 11:25:37,080 INFO X Dev Shape (18, 7) (18,)
2022-12-13 11:25:50,679 INFO Saving supervised_student to ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/supervised_student
2022-12-13 11:25:50,680 INFO Saving model at ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/supervised_student/final_model.h5
2022-12-13 11:25:50,691 INFO 

	*** Evaluating on dev data ***
2022-12-13 11:25:50,691 INFO Predicting labels for 18 texts
2022-12-13 11:25:50,839 INFO Evaluating student dev on 18 examples
2022-12-13 11:25:50,843 INFO student dev performance: 50.00
2022-12-13 11:25:50,844 INFO student dev confusion matrix:
[[3 4]
 [5 6]]
2022-12-13 11:25:50,844 INFO student dev report:
              precision    recall  f1-score   support

           0       0.38      0.43      0.40         7
           1       0.60      0.55      0.57        11

    accuracy                           0.50        18
   macro avg       0.49      0.49      0.49        18
weighted avg       0.51      0.50      0.50        18

2022-12-13 11:25:50,844 INFO 

	*** Evaluating on test data ***
2022-12-13 11:25:50,844 INFO Predicting labels for 32 texts
2022-12-13 11:25:51,118 INFO Evaluating student test on 32 examples
2022-12-13 11:25:51,123 INFO student test performance: 59.38
2022-12-13 11:25:51,124 INFO student test confusion matrix:
[[ 2 12]
 [ 1 17]]
2022-12-13 11:25:51,124 INFO student test report:
              precision    recall  f1-score   support

           0       0.67      0.14      0.24        14
           1       0.59      0.94      0.72        18

    accuracy                           0.59        32
   macro avg       0.63      0.54      0.48        32
weighted avg       0.62      0.59      0.51        32

2022-12-13 11:25:51,124 INFO initializing teacher on unlabeled data with majority voting
2022-12-13 11:25:51,124 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 11:25:51,125 INFO There are 7/7 active rules
2022-12-13 11:25:51,125 INFO Coverage: 100.0% (444/444)
2022-12-13 11:25:51,138 INFO evaluating majority voting
2022-12-13 11:25:51,138 INFO Applying Teacher with 7 LF(s) on 741 data
2022-12-13 11:25:51,139 INFO There are 7/7 active rules
2022-12-13 11:25:51,139 INFO Coverage: 100.0% (741/741)
2022-12-13 11:25:51,162 INFO Evaluating teacher train on 741 examples
2022-12-13 11:25:51,171 INFO teacher train performance: 89.88
2022-12-13 11:25:51,171 INFO teacher train confusion matrix:
[[153  42]
 [ 33 513]]
2022-12-13 11:25:51,171 INFO teacher train report:
              precision    recall  f1-score   support

           0       0.82      0.78      0.80       195
           1       0.92      0.94      0.93       546

    accuracy                           0.90       741
   macro avg       0.87      0.86      0.87       741
weighted avg       0.90      0.90      0.90       741

2022-12-13 11:25:51,172 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 11:25:51,172 INFO There are 7/7 active rules
2022-12-13 11:25:51,172 INFO Coverage: 100.0% (18/18)
2022-12-13 11:25:51,173 INFO Evaluating teacher dev on 18 examples
2022-12-13 11:25:51,178 INFO teacher dev performance: 88.89
2022-12-13 11:25:51,179 INFO teacher dev confusion matrix:
[[ 5  2]
 [ 0 11]]
2022-12-13 11:25:51,179 INFO teacher dev report:
              precision    recall  f1-score   support

           0       1.00      0.71      0.83         7
           1       0.85      1.00      0.92        11

    accuracy                           0.89        18
   macro avg       0.92      0.86      0.88        18
weighted avg       0.91      0.89      0.88        18

2022-12-13 11:25:51,179 INFO Applying Teacher with 7 LF(s) on 32 data
2022-12-13 11:25:51,180 INFO There are 7/7 active rules
2022-12-13 11:25:51,180 INFO Coverage: 100.0% (32/32)
2022-12-13 11:25:51,181 INFO Evaluating teacher test on 32 examples
2022-12-13 11:25:51,188 INFO teacher test performance: 78.12
2022-12-13 11:25:51,188 INFO teacher test confusion matrix:
[[ 8  6]
 [ 1 17]]
2022-12-13 11:25:51,188 INFO teacher test report:
              precision    recall  f1-score   support

           0       0.89      0.57      0.70        14
           1       0.74      0.94      0.83        18

    accuracy                           0.78        32
   macro avg       0.81      0.76      0.76        32
weighted avg       0.80      0.78      0.77        32

2022-12-13 11:25:51,189 INFO 

	 *** Starting loop 0 ***
2022-12-13 11:25:51,189 INFO [WARNING] sample size = 16384 > 444
2022-12-13 11:25:51,189 INFO Downsampling 444 data
2022-12-13 11:25:51,190 INFO Adding Student as extra rule in Teacher
2022-12-13 11:25:51,190 INFO Getting rule predictions
2022-12-13 11:25:51,190 INFO Applying Teacher with 7 LF(s) on 741 data
2022-12-13 11:25:51,192 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 11:25:51,192 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 11:25:51,193 INFO Getting student predictions on train (and dev) dataset
2022-12-13 11:25:51,194 INFO Predicting labels for 741 texts
2022-12-13 11:25:51,297 INFO Predicting labels for 18 texts
2022-12-13 11:25:51,395 INFO Predicting labels for 444 texts
2022-12-13 11:25:51,492 INFO Training Rule Attention Network
2022-12-13 11:25:51,500 INFO X Train Shape (741, 7) (741, 8, 2) (741,)
2022-12-13 11:25:51,501 INFO X Dev Shape (18, 7) (18, 8, 2) (18,)
2022-12-13 11:25:51,505 INFO X Unsup Shape (444, 7) (444, 8, 2)
2022-12-13 11:25:51,582 INFO 

		*** Training RAN ***
2022-12-13 11:25:54,648 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 11:25:54,649 INFO Predicting labels for 444 texts
2022-12-13 11:25:54,752 INFO There are 7/7 active rules
2022-12-13 11:25:54,752 INFO Coverage: 100.0% (444/444)
2022-12-13 11:25:54,756 INFO RAN - Predicting labels for 444 texts
2022-12-13 11:25:54,842 INFO DONE, Getting attention scores...
2022-12-13 11:25:54,906 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 11:25:54,907 INFO Predicting labels for 18 texts
2022-12-13 11:25:55,003 INFO There are 7/7 active rules
2022-12-13 11:25:55,003 INFO Coverage: 100.0% (18/18)
2022-12-13 11:25:55,004 INFO RAN - Predicting labels for 18 texts
2022-12-13 11:25:55,028 INFO DONE, Getting attention scores...
2022-12-13 11:25:55,083 INFO Evaluating teacher dev iter0 on 18 examples
2022-12-13 11:25:55,088 INFO teacher dev iter0 performance: 88.89
2022-12-13 11:25:55,088 INFO teacher dev iter0 confusion matrix:
[[ 5  2]
 [ 0 11]]
2022-12-13 11:25:55,088 INFO teacher dev iter0 report:
              precision    recall  f1-score   support

           0       1.00      0.71      0.83         7
           1       0.85      1.00      0.92        11

    accuracy                           0.89        18
   macro avg       0.92      0.86      0.88        18
weighted avg       0.91      0.89      0.88        18

2022-12-13 11:25:55,088 INFO Applying Teacher with 7 LF(s) on 32 data
2022-12-13 11:25:55,088 INFO Predicting labels for 32 texts
2022-12-13 11:25:55,189 INFO There are 7/7 active rules
2022-12-13 11:25:55,189 INFO Coverage: 100.0% (32/32)
2022-12-13 11:25:55,190 INFO RAN - Predicting labels for 32 texts
2022-12-13 11:25:55,212 INFO DONE, Getting attention scores...
2022-12-13 11:25:55,267 INFO Evaluating teacher test iter0 on 32 examples
2022-12-13 11:25:55,272 INFO teacher test iter0 performance: 78.12
2022-12-13 11:25:55,272 INFO teacher test iter0 confusion matrix:
[[ 8  6]
 [ 1 17]]
2022-12-13 11:25:55,272 INFO teacher test iter0 report:
              precision    recall  f1-score   support

           0       0.89      0.57      0.70        14
           1       0.74      0.94      0.83        18

    accuracy                           0.78        32
   macro avg       0.81      0.76      0.76        32
weighted avg       0.80      0.78      0.77        32

2022-12-13 11:25:55,272 INFO Creating Pseudo Dataset with 444 items...
2022-12-13 11:25:55,274 INFO ZEROCLASSWARNING: Class 1 has zero examples...
2022-12-13 11:25:55,275 INFO Balancing Pseudo Dataset to keep 444 items...
2022-12-13 11:25:55,279 INFO PSEUDO-DATASET:
444 examples
PSEUDO-LABELS:
0    444
Name: label, dtype: int64
2022-12-13 11:25:55,279 INFO Self-training led to trivial predictions. Stopping...
2022-12-13 11:25:55,279 INFO Final Results
2022-12-13 11:25:55,280 INFO TEACHER PERFORMANCES:
0:	88.89	78.12
1:	88.89	78.12
2022-12-13 11:25:55,280 INFO STUDENT PERFORMANCES:
0:	50.00	59.38
2022-12-13 11:25:55,280 INFO BEST DEV weighted_acc = 50.000 for epoch 0
2022-12-13 11:25:55,280 INFO FINAL TEST weighted_acc = 59.375 for epoch 0 (max=59.38 for epoch 0)
2022-12-13 11:25:55,280 INFO Saving student_last to ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/student_last
2022-12-13 11:25:55,280 INFO Saving model at ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/student_last/final_model.h5
2022-12-13 11:25:55,287 INFO Saving teacher at ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/teacher_last
2022-12-13 11:25:55,288 INFO Saving rule attention network at ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/teacher_last/rule_attention_network.h5
2022-12-13 11:25:55,294 INFO 	*** Final Results ***
2022-12-13 11:25:55,294 INFO 
student_train:	{'dev_loss': 0.8489859700202942}
2022-12-13 11:25:55,294 INFO 
supervised_student_dev:	{'acc': 50.0, 'weighted_acc': 50.0, 'prec': 48.75, 'rec': 48.701298701298704, 'f1': 48.57142857142856, 'weighted_f1': 48.57142857142856, 'ignored': 0, 'total': 18, 'perf': 50.0}
2022-12-13 11:25:55,294 INFO 
supervised_student_test:	{'acc': 59.375, 'weighted_acc': 59.375, 'prec': 62.643678160919535, 'rec': 54.36507936507936, 'f1': 47.934918648310386, 'weighted_f1': 47.934918648310386, 'ignored': 0, 'total': 32, 'perf': 59.375}
2022-12-13 11:25:55,294 INFO 
teacher_train:	{'acc': 89.87854251012146, 'weighted_acc': 89.87854251012146, 'prec': 87.34524847428074, 'rec': 86.20879120879121, 'f1': 86.75148576455192, 'weighted_f1': 86.75148576455192, 'ignored': 0, 'total': 741, 'perf': 89.87854251012146}
2022-12-13 11:25:55,294 INFO 
teacher_dev:	{'acc': 88.88888888888889, 'weighted_acc': 88.88888888888889, 'prec': 92.3076923076923, 'rec': 85.71428571428572, 'f1': 87.5, 'weighted_f1': 87.5, 'ignored': 0, 'total': 18, 'perf': 88.88888888888889}
2022-12-13 11:25:55,294 INFO 
teacher_test:	{'acc': 78.125, 'weighted_acc': 78.125, 'prec': 81.40096618357488, 'rec': 75.79365079365078, 'f1': 76.24602332979852, 'weighted_f1': 76.24602332979852, 'ignored': 0, 'total': 32, 'perf': 78.125}
2022-12-13 11:25:55,294 INFO 
teacher_train_iter:	[{'acc': 89.87854251012146, 'weighted_acc': 89.87854251012146, 'prec': 87.34524847428074, 'rec': 86.20879120879121, 'f1': 86.75148576455192, 'weighted_f1': 86.75148576455192, 'ignored': 0, 'total': 741, 'perf': 89.87854251012146}]
2022-12-13 11:25:55,294 INFO 
teacher_dev_iter:	[{'acc': 88.88888888888889, 'weighted_acc': 88.88888888888889, 'prec': 92.3076923076923, 'rec': 85.71428571428572, 'f1': 87.5, 'weighted_f1': 87.5, 'ignored': 0, 'total': 18, 'perf': 88.88888888888889}, {'acc': 88.88888888888889, 'weighted_acc': 88.88888888888889, 'prec': 92.3076923076923, 'rec': 85.71428571428572, 'f1': 87.5, 'weighted_f1': 87.5, 'ignored': 0, 'total': 18, 'perf': 88.88888888888889}]
2022-12-13 11:25:55,294 INFO 
teacher_test_iter:	[{'acc': 78.125, 'weighted_acc': 78.125, 'prec': 81.40096618357488, 'rec': 75.79365079365078, 'f1': 76.24602332979852, 'weighted_f1': 76.24602332979852, 'ignored': 0, 'total': 32, 'perf': 78.125}, {'acc': 78.125, 'weighted_acc': 78.125, 'prec': 81.40096618357488, 'rec': 75.79365079365078, 'f1': 76.24602332979852, 'weighted_f1': 76.24602332979852, 'ignored': 0, 'total': 32, 'perf': 78.125}]
2022-12-13 11:25:55,295 INFO 
student_train_iter:	[{'dev_loss': 0.8489859700202942}]
2022-12-13 11:25:55,295 INFO 
student_dev_iter:	[{'acc': 50.0, 'weighted_acc': 50.0, 'prec': 48.75, 'rec': 48.701298701298704, 'f1': 48.57142857142856, 'weighted_f1': 48.57142857142856, 'ignored': 0, 'total': 18, 'perf': 50.0}]
2022-12-13 11:25:55,295 INFO 
student_test_iter:	[{'acc': 59.375, 'weighted_acc': 59.375, 'prec': 62.643678160919535, 'rec': 54.36507936507936, 'f1': 47.934918648310386, 'weighted_f1': 47.934918648310386, 'ignored': 0, 'total': 32, 'perf': 59.375}]
2022-12-13 11:25:55,295 INFO 
student_dev:	{'acc': 50.0, 'weighted_acc': 50.0, 'prec': 48.75, 'rec': 48.701298701298704, 'f1': 48.57142857142856, 'weighted_f1': 48.57142857142856, 'ignored': 0, 'total': 18, 'perf': 50.0}
2022-12-13 11:25:55,295 INFO 
student_test:	{'acc': 59.375, 'weighted_acc': 59.375, 'prec': 62.643678160919535, 'rec': 54.36507936507936, 'f1': 47.934918648310386, 'weighted_f1': 47.934918648310386, 'ignored': 0, 'total': 32, 'perf': 59.375}
2022-12-13 11:25:55,295 INFO Saving results at ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/results.pkl
2022-12-13 11:25:55,298 INFO Dataset: econ
2022-12-13 11:25:55,298 INFO Weak Sources: ['econrules']
2022-12-13 11:25:55,298 INFO Model: bert

2022-12-13 11:25:55,298 INFO Teacher Train weighted_acc: 89.9
2022-12-13 11:25:55,298 INFO Teacher Dev weighted_acc: 88.9
2022-12-13 11:25:55,298 INFO Teacher Test weighted_acc: 78.1

2022-12-13 11:25:55,298 INFO Student Dev weighted_acc: 50.0
2022-12-13 11:25:55,298 INFO Student Test weighted_acc: 59.4
2022-12-13 11:25:55,300 INFO Saved report at ../experiments/econ/Dec13_11-25_ECON_experiments/seed0/2022_12_13-11_25_stBERT/results.txt
