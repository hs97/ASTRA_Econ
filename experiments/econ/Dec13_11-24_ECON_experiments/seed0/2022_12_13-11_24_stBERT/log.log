2022-12-13 11:24:17,318 INFO 

		 *** NEW EXPERIMENT ***
args=Namespace(adam_epsilon=1e-08, convert_abstain_to_random=False, datapath='../data', dataset='econ', debug=False, device=device(type='cuda'), downsample=1.0, eval_batch_size=16, experiment_folder='../experiments/econ', finetuning_rate=0.0001, fp16=False, hard_student_rule=False, learning_rate=0.0001, logdir='../experiments/econ/Dec13_11-24_ECON_experiments/seed0/2022_12_13-11_24_stBERT', logging_steps=500, loss_weights=False, lower_case=False, max_grad_norm=1.0, max_rule_seq_length=10, max_seq_length=64, max_size=1000, metric='weighted_acc', n_gpu=1, no_cuda=False, num_epochs=15, num_iter=25, num_labels=2, num_supervised_trials=5, num_unsup_epochs=25, oversample=3, overwrite=False, sample_size=16384, seed=0, soft_labels=False, student_name='bert', teacher_name='ran', tokenizer_method='clean', train_batch_size=16, unsup_batch_size=128, warmup_steps=0, weak_sources=None, weight_decay=0.0)
2022-12-13 11:24:17,318 INFO building student: bert
2022-12-13 11:24:17,318 INFO building teacher
2022-12-13 11:24:17,318 INFO No weak sources specified for Teacher. Using default: ['econrules']
2022-12-13 11:24:17,319 INFO loading data
2022-12-13 11:24:17,326 INFO Pre-processing train data for student...
2022-12-13 11:24:17,330 INFO train DATASET: 247 examples
2022-12-13 11:24:17,332 INFO train LABELS:
1    182
0     65
Name: label, dtype: int64
2022-12-13 11:24:17,333 INFO Oversampling train data 3 times
2022-12-13 11:24:17,335 INFO train DATASET: 741 examples
2022-12-13 11:24:17,337 INFO train LABELS:
1    546
0    195
Name: label, dtype: int64
2022-12-13 11:24:17,340 INFO Pre-processing dev data for student...
2022-12-13 11:24:17,342 INFO dev DATASET: 18 examples
2022-12-13 11:24:17,343 INFO dev LABELS:
1    11
0     7
Name: label, dtype: int64
2022-12-13 11:24:17,346 INFO Pre-processing test data for student...
2022-12-13 11:24:17,349 INFO test DATASET: 32 examples
2022-12-13 11:24:17,350 INFO test LABELS:
1    18
0    14
Name: label, dtype: int64
2022-12-13 11:24:17,354 INFO Pre-processing unlabeled data for student...
2022-12-13 11:24:17,357 INFO unlabeled DATASET: 444 examples
2022-12-13 11:24:17,359 INFO unlabeled LABELS:
Series([], Name: label, dtype: int64)
2022-12-13 11:24:17,359 INFO creating pseudo-dataset
2022-12-13 11:24:17,359 INFO copying data from unlabeled dataset
2022-12-13 11:24:17,367 INFO done
2022-12-13 11:24:17,367 INFO [WARNING] sample size = 16384 > 444
2022-12-13 11:24:17,367 INFO Downsampling 444 data
2022-12-13 11:24:17,368 INFO copying data from train dataset
2022-12-13 11:24:17,377 INFO done
2022-12-13 11:24:17,378 INFO Balancing Pseudo Dataset to keep 1092 items...
2022-12-13 11:24:17,382 INFO PSEUDO-DATASET:
1092 examples
PSEUDO-LABELS:
1    546
0    546
Name: label, dtype: int64
2022-12-13 11:24:17,383 INFO Class labels: 2
2022-12-13 11:24:17,384 INFO X Train Shape (1092, 7) (1092,)
2022-12-13 11:24:17,385 INFO X Dev Shape (18, 7) (18,)
2022-12-13 11:24:30,018 INFO Saving supervised_student to ../experiments/econ/Dec13_11-24_ECON_experiments/seed0/2022_12_13-11_24_stBERT/supervised_student
2022-12-13 11:24:30,018 INFO Saving model at ../experiments/econ/Dec13_11-24_ECON_experiments/seed0/2022_12_13-11_24_stBERT/supervised_student/final_model.h5
2022-12-13 11:24:30,024 INFO 

	*** Evaluating on dev data ***
2022-12-13 11:24:30,024 INFO Predicting labels for 18 texts
2022-12-13 11:24:30,126 INFO Evaluating student dev on 18 examples
2022-12-13 11:24:30,130 INFO student dev performance: 50.00
2022-12-13 11:24:30,131 INFO student dev confusion matrix:
[[3 4]
 [5 6]]
2022-12-13 11:24:30,131 INFO student dev report:
              precision    recall  f1-score   support

           0       0.38      0.43      0.40         7
           1       0.60      0.55      0.57        11

    accuracy                           0.50        18
   macro avg       0.49      0.49      0.49        18
weighted avg       0.51      0.50      0.50        18

2022-12-13 11:24:30,131 INFO 

	*** Evaluating on test data ***
2022-12-13 11:24:30,131 INFO Predicting labels for 32 texts
2022-12-13 11:24:30,398 INFO Evaluating student test on 32 examples
2022-12-13 11:24:30,402 INFO student test performance: 59.38
2022-12-13 11:24:30,402 INFO student test confusion matrix:
[[ 2 12]
 [ 1 17]]
2022-12-13 11:24:30,402 INFO student test report:
              precision    recall  f1-score   support

           0       0.67      0.14      0.24        14
           1       0.59      0.94      0.72        18

    accuracy                           0.59        32
   macro avg       0.63      0.54      0.48        32
weighted avg       0.62      0.59      0.51        32

2022-12-13 11:24:30,402 INFO initializing teacher on unlabeled data with majority voting
2022-12-13 11:24:30,403 INFO Applying Teacher with 7 LF(s) on 444 data
