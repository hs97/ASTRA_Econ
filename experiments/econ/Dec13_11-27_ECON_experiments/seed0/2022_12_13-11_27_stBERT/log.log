2022-12-13 11:27:11,340 INFO 

		 *** NEW EXPERIMENT ***
args=Namespace(adam_epsilon=1e-08, convert_abstain_to_random=False, datapath='../data', dataset='econ', debug=False, device=device(type='cuda'), downsample=1.0, eval_batch_size=16, experiment_folder='../experiments/econ', finetuning_rate=0.0001, fp16=False, hard_student_rule=False, learning_rate=0.0001, logdir='../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT', logging_steps=500, loss_weights=False, lower_case=False, max_grad_norm=1.0, max_rule_seq_length=10, max_seq_length=64, max_size=1000, metric='weighted_acc', n_gpu=1, no_cuda=False, num_epochs=15, num_iter=25, num_labels=2, num_supervised_trials=5, num_unsup_epochs=25, oversample=3, overwrite=False, sample_size=16384, seed=0, soft_labels=False, student_name='bert', teacher_name='ran', tokenizer_method='clean', train_batch_size=16, unsup_batch_size=128, warmup_steps=0, weak_sources=None, weight_decay=0.0)
2022-12-13 11:27:11,340 INFO building student: bert
2022-12-13 11:27:11,340 INFO building teacher
2022-12-13 11:27:11,340 INFO No weak sources specified for Teacher. Using default: ['econrules']
2022-12-13 11:27:11,340 INFO loading data
2022-12-13 11:27:11,342 INFO Pre-processing train data for student...
2022-12-13 11:27:11,345 INFO train DATASET: 247 examples
2022-12-13 11:27:11,348 INFO train LABELS:
1    182
0     65
Name: label, dtype: int64
2022-12-13 11:27:11,348 INFO Oversampling train data 3 times
2022-12-13 11:27:11,351 INFO train DATASET: 741 examples
2022-12-13 11:27:11,352 INFO train LABELS:
1    546
0    195
Name: label, dtype: int64
2022-12-13 11:27:11,353 INFO Pre-processing dev data for student...
2022-12-13 11:27:11,356 INFO dev DATASET: 18 examples
2022-12-13 11:27:11,357 INFO dev LABELS:
1    11
0     7
Name: label, dtype: int64
2022-12-13 11:27:11,358 INFO Pre-processing test data for student...
2022-12-13 11:27:11,361 INFO test DATASET: 32 examples
2022-12-13 11:27:11,362 INFO test LABELS:
1    18
0    14
Name: label, dtype: int64
2022-12-13 11:27:11,364 INFO Pre-processing unlabeled data for student...
2022-12-13 11:27:11,366 INFO unlabeled DATASET: 444 examples
2022-12-13 11:27:11,369 INFO unlabeled LABELS:
0    444
Name: label, dtype: int64
2022-12-13 11:27:11,369 INFO creating pseudo-dataset
2022-12-13 11:27:11,369 INFO copying data from unlabeled dataset
2022-12-13 11:27:11,379 INFO done
2022-12-13 11:27:11,379 INFO [WARNING] sample size = 16384 > 444
2022-12-13 11:27:11,379 INFO Downsampling 444 data
2022-12-13 11:27:11,379 INFO copying data from train dataset
2022-12-13 11:27:11,389 INFO done
2022-12-13 11:27:11,390 INFO Balancing Pseudo Dataset to keep 1092 items...
2022-12-13 11:27:11,394 INFO PSEUDO-DATASET:
1092 examples
PSEUDO-LABELS:
1    546
0    546
Name: label, dtype: int64
2022-12-13 11:27:11,394 INFO Class labels: 2
2022-12-13 11:27:11,396 INFO X Train Shape (1092, 7) (1092,)
2022-12-13 11:27:11,396 INFO X Dev Shape (18, 7) (18,)
2022-12-13 11:27:22,803 INFO Saving supervised_student to ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/supervised_student
2022-12-13 11:27:22,804 INFO Saving model at ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/supervised_student/final_model.h5
2022-12-13 11:27:22,810 INFO 

	*** Evaluating on dev data ***
2022-12-13 11:27:22,810 INFO Predicting labels for 18 texts
2022-12-13 11:27:23,927 INFO Evaluating student dev on 18 examples
2022-12-13 11:27:23,931 INFO student dev performance: 50.00
2022-12-13 11:27:23,932 INFO student dev confusion matrix:
[[3 4]
 [5 6]]
2022-12-13 11:27:23,932 INFO student dev report:
              precision    recall  f1-score   support

           0       0.38      0.43      0.40         7
           1       0.60      0.55      0.57        11

    accuracy                           0.50        18
   macro avg       0.49      0.49      0.49        18
weighted avg       0.51      0.50      0.50        18

2022-12-13 11:27:23,932 INFO 

	*** Evaluating on test data ***
2022-12-13 11:27:23,932 INFO Predicting labels for 32 texts
2022-12-13 11:27:24,201 INFO Evaluating student test on 32 examples
2022-12-13 11:27:24,205 INFO student test performance: 59.38
2022-12-13 11:27:24,205 INFO student test confusion matrix:
[[ 2 12]
 [ 1 17]]
2022-12-13 11:27:24,205 INFO student test report:
              precision    recall  f1-score   support

           0       0.67      0.14      0.24        14
           1       0.59      0.94      0.72        18

    accuracy                           0.59        32
   macro avg       0.63      0.54      0.48        32
weighted avg       0.62      0.59      0.51        32

2022-12-13 11:27:24,205 INFO initializing teacher on unlabeled data with majority voting
2022-12-13 11:27:24,205 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 11:27:24,206 INFO There are 7/7 active rules
2022-12-13 11:27:24,206 INFO Coverage: 100.0% (444/444)
2022-12-13 11:27:24,219 INFO evaluating majority voting
2022-12-13 11:27:24,219 INFO Applying Teacher with 7 LF(s) on 741 data
2022-12-13 11:27:24,220 INFO There are 7/7 active rules
2022-12-13 11:27:24,220 INFO Coverage: 100.0% (741/741)
2022-12-13 11:27:24,242 INFO Evaluating teacher train on 741 examples
2022-12-13 11:27:24,255 INFO teacher train performance: 89.88
2022-12-13 11:27:24,255 INFO teacher train confusion matrix:
[[153  42]
 [ 33 513]]
2022-12-13 11:27:24,255 INFO teacher train report:
              precision    recall  f1-score   support

           0       0.82      0.78      0.80       195
           1       0.92      0.94      0.93       546

    accuracy                           0.90       741
   macro avg       0.87      0.86      0.87       741
weighted avg       0.90      0.90      0.90       741

2022-12-13 11:27:24,255 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 11:27:24,256 INFO There are 7/7 active rules
2022-12-13 11:27:24,256 INFO Coverage: 100.0% (18/18)
2022-12-13 11:27:24,256 INFO Evaluating teacher dev on 18 examples
2022-12-13 11:27:24,261 INFO teacher dev performance: 88.89
2022-12-13 11:27:24,261 INFO teacher dev confusion matrix:
[[ 5  2]
 [ 0 11]]
2022-12-13 11:27:24,261 INFO teacher dev report:
              precision    recall  f1-score   support

           0       1.00      0.71      0.83         7
           1       0.85      1.00      0.92        11

    accuracy                           0.89        18
   macro avg       0.92      0.86      0.88        18
weighted avg       0.91      0.89      0.88        18

2022-12-13 11:27:24,262 INFO Applying Teacher with 7 LF(s) on 32 data
2022-12-13 11:27:24,263 INFO There are 7/7 active rules
2022-12-13 11:27:24,263 INFO Coverage: 100.0% (32/32)
2022-12-13 11:27:24,264 INFO Evaluating teacher test on 32 examples
2022-12-13 11:27:24,269 INFO teacher test performance: 78.12
2022-12-13 11:27:24,269 INFO teacher test confusion matrix:
[[ 8  6]
 [ 1 17]]
2022-12-13 11:27:24,269 INFO teacher test report:
              precision    recall  f1-score   support

           0       0.89      0.57      0.70        14
           1       0.74      0.94      0.83        18

    accuracy                           0.78        32
   macro avg       0.81      0.76      0.76        32
weighted avg       0.80      0.78      0.77        32

2022-12-13 11:27:24,269 INFO 

	 *** Starting loop 0 ***
2022-12-13 11:27:24,270 INFO [WARNING] sample size = 16384 > 444
2022-12-13 11:27:24,270 INFO Downsampling 444 data
2022-12-13 11:27:24,270 INFO Adding Student as extra rule in Teacher
2022-12-13 11:27:24,271 INFO Getting rule predictions
2022-12-13 11:27:24,271 INFO Applying Teacher with 7 LF(s) on 741 data
2022-12-13 11:27:24,272 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 11:27:24,272 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 11:27:24,272 INFO Getting student predictions on train (and dev) dataset
2022-12-13 11:27:24,273 INFO Predicting labels for 741 texts
2022-12-13 11:27:24,387 INFO Predicting labels for 18 texts
2022-12-13 11:27:24,487 INFO Predicting labels for 444 texts
2022-12-13 11:27:24,588 INFO Training Rule Attention Network
2022-12-13 11:27:24,596 INFO X Train Shape (741, 7) (741, 8, 2) (741,)
2022-12-13 11:27:24,596 INFO X Dev Shape (18, 7) (18, 8, 2) (18,)
2022-12-13 11:27:24,600 INFO X Unsup Shape (444, 7) (444, 8, 2)
2022-12-13 11:27:24,601 INFO fired rules
2022-12-13 11:27:24,601 INFO [[8. 1. 2. ... 5. 6. 7.]
 [8. 1. 2. ... 5. 6. 7.]
 [8. 1. 2. ... 5. 6. 7.]
 ...
 [8. 1. 2. ... 5. 6. 7.]
 [8. 1. 2. ... 5. 6. 7.]
 [8. 1. 2. ... 5. 6. 7.]]
2022-12-13 11:27:24,679 INFO 

		*** Training RAN ***
2022-12-13 11:27:27,669 INFO Applying Teacher with 7 LF(s) on 444 data
2022-12-13 11:27:27,670 INFO Predicting labels for 444 texts
2022-12-13 11:27:27,772 INFO There are 7/7 active rules
2022-12-13 11:27:27,772 INFO Coverage: 100.0% (444/444)
2022-12-13 11:27:27,776 INFO RAN - Predicting labels for 444 texts
2022-12-13 11:27:27,866 INFO DONE, Getting attention scores...
2022-12-13 11:27:27,929 INFO Applying Teacher with 7 LF(s) on 18 data
2022-12-13 11:27:27,929 INFO Predicting labels for 18 texts
2022-12-13 11:27:28,031 INFO There are 7/7 active rules
2022-12-13 11:27:28,031 INFO Coverage: 100.0% (18/18)
2022-12-13 11:27:28,032 INFO RAN - Predicting labels for 18 texts
2022-12-13 11:27:28,058 INFO DONE, Getting attention scores...
2022-12-13 11:27:28,115 INFO Evaluating teacher dev iter0 on 18 examples
2022-12-13 11:27:28,119 INFO teacher dev iter0 performance: 88.89
2022-12-13 11:27:28,119 INFO teacher dev iter0 confusion matrix:
[[ 5  2]
 [ 0 11]]
2022-12-13 11:27:28,119 INFO teacher dev iter0 report:
              precision    recall  f1-score   support

           0       1.00      0.71      0.83         7
           1       0.85      1.00      0.92        11

    accuracy                           0.89        18
   macro avg       0.92      0.86      0.88        18
weighted avg       0.91      0.89      0.88        18

2022-12-13 11:27:28,119 INFO Applying Teacher with 7 LF(s) on 32 data
2022-12-13 11:27:28,119 INFO Predicting labels for 32 texts
2022-12-13 11:27:28,225 INFO There are 7/7 active rules
2022-12-13 11:27:28,225 INFO Coverage: 100.0% (32/32)
2022-12-13 11:27:28,226 INFO RAN - Predicting labels for 32 texts
2022-12-13 11:27:28,252 INFO DONE, Getting attention scores...
2022-12-13 11:27:28,307 INFO Evaluating teacher test iter0 on 32 examples
2022-12-13 11:27:28,311 INFO teacher test iter0 performance: 78.12
2022-12-13 11:27:28,311 INFO teacher test iter0 confusion matrix:
[[ 8  6]
 [ 1 17]]
2022-12-13 11:27:28,311 INFO teacher test iter0 report:
              precision    recall  f1-score   support

           0       0.89      0.57      0.70        14
           1       0.74      0.94      0.83        18

    accuracy                           0.78        32
   macro avg       0.81      0.76      0.76        32
weighted avg       0.80      0.78      0.77        32

2022-12-13 11:27:28,311 INFO Creating Pseudo Dataset with 444 items...
2022-12-13 11:27:28,312 INFO ZEROCLASSWARNING: Class 1 has zero examples...
2022-12-13 11:27:28,313 INFO Balancing Pseudo Dataset to keep 444 items...
2022-12-13 11:27:28,316 INFO PSEUDO-DATASET:
444 examples
PSEUDO-LABELS:
0    444
Name: label, dtype: int64
2022-12-13 11:27:28,317 INFO Self-training led to trivial predictions. Stopping...
2022-12-13 11:27:28,317 INFO Final Results
2022-12-13 11:27:28,317 INFO TEACHER PERFORMANCES:
0:	88.89	78.12
1:	88.89	78.12
2022-12-13 11:27:28,317 INFO STUDENT PERFORMANCES:
0:	50.00	59.38
2022-12-13 11:27:28,317 INFO BEST DEV weighted_acc = 50.000 for epoch 0
2022-12-13 11:27:28,318 INFO FINAL TEST weighted_acc = 59.375 for epoch 0 (max=59.38 for epoch 0)
2022-12-13 11:27:28,318 INFO Saving student_last to ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/student_last
2022-12-13 11:27:28,318 INFO Saving model at ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/student_last/final_model.h5
2022-12-13 11:27:28,325 INFO Saving teacher at ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/teacher_last
2022-12-13 11:27:28,326 INFO Saving rule attention network at ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/teacher_last/rule_attention_network.h5
2022-12-13 11:27:28,334 INFO 	*** Final Results ***
2022-12-13 11:27:28,335 INFO 
student_train:	{'dev_loss': 0.8489859700202942}
2022-12-13 11:27:28,335 INFO 
supervised_student_dev:	{'acc': 50.0, 'weighted_acc': 50.0, 'prec': 48.75, 'rec': 48.701298701298704, 'f1': 48.57142857142856, 'weighted_f1': 48.57142857142856, 'ignored': 0, 'total': 18, 'perf': 50.0}
2022-12-13 11:27:28,335 INFO 
supervised_student_test:	{'acc': 59.375, 'weighted_acc': 59.375, 'prec': 62.643678160919535, 'rec': 54.36507936507936, 'f1': 47.934918648310386, 'weighted_f1': 47.934918648310386, 'ignored': 0, 'total': 32, 'perf': 59.375}
2022-12-13 11:27:28,335 INFO 
teacher_train:	{'acc': 89.87854251012146, 'weighted_acc': 89.87854251012146, 'prec': 87.34524847428074, 'rec': 86.20879120879121, 'f1': 86.75148576455192, 'weighted_f1': 86.75148576455192, 'ignored': 0, 'total': 741, 'perf': 89.87854251012146}
2022-12-13 11:27:28,335 INFO 
teacher_dev:	{'acc': 88.88888888888889, 'weighted_acc': 88.88888888888889, 'prec': 92.3076923076923, 'rec': 85.71428571428572, 'f1': 87.5, 'weighted_f1': 87.5, 'ignored': 0, 'total': 18, 'perf': 88.88888888888889}
2022-12-13 11:27:28,335 INFO 
teacher_test:	{'acc': 78.125, 'weighted_acc': 78.125, 'prec': 81.40096618357488, 'rec': 75.79365079365078, 'f1': 76.24602332979852, 'weighted_f1': 76.24602332979852, 'ignored': 0, 'total': 32, 'perf': 78.125}
2022-12-13 11:27:28,335 INFO 
teacher_train_iter:	[{'acc': 89.87854251012146, 'weighted_acc': 89.87854251012146, 'prec': 87.34524847428074, 'rec': 86.20879120879121, 'f1': 86.75148576455192, 'weighted_f1': 86.75148576455192, 'ignored': 0, 'total': 741, 'perf': 89.87854251012146}]
2022-12-13 11:27:28,335 INFO 
teacher_dev_iter:	[{'acc': 88.88888888888889, 'weighted_acc': 88.88888888888889, 'prec': 92.3076923076923, 'rec': 85.71428571428572, 'f1': 87.5, 'weighted_f1': 87.5, 'ignored': 0, 'total': 18, 'perf': 88.88888888888889}, {'acc': 88.88888888888889, 'weighted_acc': 88.88888888888889, 'prec': 92.3076923076923, 'rec': 85.71428571428572, 'f1': 87.5, 'weighted_f1': 87.5, 'ignored': 0, 'total': 18, 'perf': 88.88888888888889}]
2022-12-13 11:27:28,335 INFO 
teacher_test_iter:	[{'acc': 78.125, 'weighted_acc': 78.125, 'prec': 81.40096618357488, 'rec': 75.79365079365078, 'f1': 76.24602332979852, 'weighted_f1': 76.24602332979852, 'ignored': 0, 'total': 32, 'perf': 78.125}, {'acc': 78.125, 'weighted_acc': 78.125, 'prec': 81.40096618357488, 'rec': 75.79365079365078, 'f1': 76.24602332979852, 'weighted_f1': 76.24602332979852, 'ignored': 0, 'total': 32, 'perf': 78.125}]
2022-12-13 11:27:28,335 INFO 
student_train_iter:	[{'dev_loss': 0.8489859700202942}]
2022-12-13 11:27:28,335 INFO 
student_dev_iter:	[{'acc': 50.0, 'weighted_acc': 50.0, 'prec': 48.75, 'rec': 48.701298701298704, 'f1': 48.57142857142856, 'weighted_f1': 48.57142857142856, 'ignored': 0, 'total': 18, 'perf': 50.0}]
2022-12-13 11:27:28,335 INFO 
student_test_iter:	[{'acc': 59.375, 'weighted_acc': 59.375, 'prec': 62.643678160919535, 'rec': 54.36507936507936, 'f1': 47.934918648310386, 'weighted_f1': 47.934918648310386, 'ignored': 0, 'total': 32, 'perf': 59.375}]
2022-12-13 11:27:28,335 INFO 
student_dev:	{'acc': 50.0, 'weighted_acc': 50.0, 'prec': 48.75, 'rec': 48.701298701298704, 'f1': 48.57142857142856, 'weighted_f1': 48.57142857142856, 'ignored': 0, 'total': 18, 'perf': 50.0}
2022-12-13 11:27:28,335 INFO 
student_test:	{'acc': 59.375, 'weighted_acc': 59.375, 'prec': 62.643678160919535, 'rec': 54.36507936507936, 'f1': 47.934918648310386, 'weighted_f1': 47.934918648310386, 'ignored': 0, 'total': 32, 'perf': 59.375}
2022-12-13 11:27:28,335 INFO Saving results at ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/results.pkl
2022-12-13 11:27:28,338 INFO Dataset: econ
2022-12-13 11:27:28,338 INFO Weak Sources: ['econrules']
2022-12-13 11:27:28,338 INFO Model: bert

2022-12-13 11:27:28,338 INFO Teacher Train weighted_acc: 89.9
2022-12-13 11:27:28,338 INFO Teacher Dev weighted_acc: 88.9
2022-12-13 11:27:28,338 INFO Teacher Test weighted_acc: 78.1

2022-12-13 11:27:28,338 INFO Student Dev weighted_acc: 50.0
2022-12-13 11:27:28,338 INFO Student Test weighted_acc: 59.4
2022-12-13 11:27:28,339 INFO Saved report at ../experiments/econ/Dec13_11-27_ECON_experiments/seed0/2022_12_13-11_27_stBERT/results.txt
